<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>Village Help â€“ Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body { font-family: Arial; background:#f2f2f2; }
    .box { max-width:500px; margin:auto; background:#fff; padding:20px; margin-top:20px; border-radius:10px; }
    input, select, button { width:100%; padding:10px; margin-top:10px; }
    button { background:#333; color:#fff; border:none; }
    .card { background:#eef6ff; padding:10px; margin-top:10px; border-radius:6px; }
  </style>
</head>

<body>

<!-- ğŸ” LOGIN -->
<div class="box" id="loginBox">
  <h2>ğŸ” Admin Login</h2>
  <input id="password" type="password" placeholder="Admin Password">
  <button onclick="login()">Login</button>
</div>

<!-- ğŸ“Š DASHBOARD -->
<div class="box" id="dashboard" style="display:none;">
  <h2>ğŸ“Š Admin Dashboard</h2>

  <h3>â• Add Worker</h3>
  <input id="wname" placeholder="Worker Name">
  <input id="wmobile" placeholder="Mobile Number">
  <select id="wservice">
    <option>Electrician</option>
    <option>Plumber</option>
  </select>
  <button onclick="addWorker()">Add Worker</button>

  <h3>ğŸ‘· All Workers</h3>
  <div id="workers"></div>
</div>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyByMmFPEZEH6ECLKNHyL6RdvNrY-zWHBpU",
    authDomain: "village-help.firebaseapp.com",
    projectId: "village-help"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const ADMIN_PASSWORD = "Villaghelp123";

  function login() {
    if (password.value !== ADMIN_PASSWORD) {
      alert("Wrong password");
      return;
    }
    loginBox.style.display = "none";
    dashboard.style.display = "block";
    loadWorkers();
  }

  // â• Add Worker
  function addWorker() {
    db.collection("workers").add({
      name: wname.value,
      mobile: wmobile.value,
      service: wservice.value,
      active: true
    }).then(() => {
      alert("Worker Added");
      wname.value = wmobile.value = "";
      loadWorkers();
    });
  }

  // ğŸ‘· Load Workers
  function loadWorkers() {
    workers.innerHTML = "";
    db.collection("workers").onSnapshot(snap => {
      workers.innerHTML = "";
      snap.forEach(doc => {
        let w = doc.data();
        workers.innerHTML += `
          <div class="card">
            <b>${w.name}</b><br>
            Mobile: ${w.mobile}<br>
            Service: ${w.service}<br>
            Status: <b>${w.active ? "Active" : "Inactive"}</b><br>
            <button onclick="toggleWorker('${doc.id}', ${w.active})">
              ${w.active ? "Deactivate" : "Activate"}
            </button>
          </div>
        `;
      });
    });
  }

  // ğŸ” Activate / Deactivate
  function toggleWorker(id, status) {
    db.collection("workers").doc(id).update({
      active: !status
    });
  }
</script>

</body>
</html>
