<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>Village Help - Admin Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body { font-family: Arial; background:#f2f2f2; }
    .box { max-width:500px; margin:auto; background:#fff; padding:20px; margin-top:20px; border-radius:10px; }
    input, select, button { width:100%; padding:10px; margin-top:10px; }
    button { background:#007bff; color:#fff; border:none; }
    h2 { text-align:center; }
    .list { background:#eef6ff; padding:10px; margin-top:10px; border-radius:5px; }
    .call { background:#28a745; margin-top:5px; }
  </style>
</head>

<body>

<!-- üîê Login -->
<div class="box" id="loginBox">
  <h2>Admin Login</h2>
  <input id="pass" type="password" placeholder="Admin Password">
  <button onclick="login()">Login</button>
</div>

<!-- üë®‚Äçüíº Admin Panel -->
<div class="box" id="panel" style="display:none;">
  <h2>Village Help - Admin</h2>

  <h3>‚ûï Worker ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h3>
  <input id="wname" placeholder="Worker Name">
  <input id="wmobile" placeholder="Mobile Number">
  <input id="wvillage" placeholder="Village">
  <select id="wservice">
    <option>Electrician</option>
    <option>Plumber</option>
  </select>
  <button onclick="addWorker()">Add Worker</button>

  <h3>üìã Bookings</h3>
  <div id="bookings"></div>
</div>

<script>
  // ‚úÖ Firebase Config (FINAL ‚Äì SAME AS index.html)
  const firebaseConfig = {
    apiKey: "AIzaSyByMmFPEZEH6ECLKNHyL6RdvNrY-zWHBpU",
    authDomain: "village-help.firebaseapp.com",
    projectId: "village-help",
    storageBucket: "village-help.firebasestorage.app",
    messagingSenderId: "639842342038",
    appId: "1:639842342038:web:7effe000ed9bae0fc31eb7",
    measurementId: "G-EQT8S6Y8PD"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // üîê Login
  function login() {
    if (pass.value === "villagehelp123") {
      loginBox.style.display = "none";
      panel.style.display = "block";
      loadBookings();
    } else {
      alert("‡§ó‡§≤‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°");
    }
  }

  // ‚ûï Add Worker
  function addWorker() {
    db.collection("workers").add({
      name: wname.value,
      mobile: wmobile.value,
      village: wvillage.value,
      service: wservice.value,
      active: true
    });
    alert("Worker Added");
  }

  // üìã Load Bookings
  function loadBookings() {
    db.collection("bookings").orderBy("time","desc")
      .onSnapshot(snapshot => {
        bookings.innerHTML = "";
        snapshot.forEach(doc => {
          let d = doc.data();
          bookings.innerHTML += `
            <div class="list">
              <b>${d.service}</b><br>
              ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï: ${d.name} (${d.mobile})<br>
              Worker: ${d.workerName}<br>
              ‡§ó‡§æ‡§Å‡§µ: ${d.village}<br>
              <a href="tel:${d.mobile}">
                <button class="call">üìû Customer</button>
              </a>
              <a href="tel:${d.workerMobile}">
                <button class="call">üìû Worker</button>
              </a>
            </div>
          `;
        });
      });
  }
</script>

</body>
</html>
